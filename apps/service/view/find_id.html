<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>TrendScope - 아이디 찾기</title>
  <link rel="stylesheet" href="/view/find_id.css">
</head>

<body id="tsFindIdPage">
  <div class="tsWrap">
    <div class="tsShell">

      <!-- LEFT -->
      <div class="tsLeft">
        <div class="tsLogo">TrendScope</div>
        <p class="tsDesc">
          통합 ID로 TrendScope의 모든 서비스를 이용할 수 있습니다.<br>
          경제 이슈와 키워드를 한 번에 탐색하세요.
        </p>
        <div class="tsStatus">
          <span class="tsDot"></span>
          오늘의 데이터 업데이트 완료
        </div>
      </div>

      <!-- RIGHT -->
      <div class="tsRight">
        <div class="tsCard">
          <div class="tsTitle">아이디 찾기</div>

          <!-- ✅ 입력 폼 (이름 + 이메일) -->
          <form id="tsFindForm" action="#">
            <div class="tsField">
              <div class="tsLabelRow">이름 <span class="tsReq">필수</span></div>
              <input id="tsName" class="tsInput" type="text" placeholder="이름" autocomplete="name" />
            </div>

            <div class="tsField">
              <div class="tsLabelRow">이메일 <span class="tsReq">필수</span></div>
              <input id="tsEmail" class="tsInput" type="email" placeholder="이메일" autocomplete="email" />
            </div>

            <button class="tsBtn" type="submit">확인</button>
          </form>

          <!-- ✅ 결과 화면 (처음엔 숨김) -->
          <section id="tsResultSection" class="tsResultWrap isHidden" aria-live="polite">
            <div class="tsResultBox">
              <p class="tsResultMsg">아이디 찾기 결과 입니다.</p>
              <p class="tsResultId" id="tsFoundId">-</p>
            </div>

            <div class="tsActionGroup">
              <a class="tsActionBtn tsActionBtnPrimary" href="./login.html" id="tsGoLogin">
                로그인 하러 가기
              </a>
              <a class="tsActionBtn tsActionBtnGhost" href="./reset_password.html" id="tsGoResetPw">
                비밀번호 재설정하기
              </a>
            </div>
          </section>

        </div>
      </div>

    </div>
  </div>

  <!-- 팝업 -->
  <div id="tsPopupLayer" aria-hidden="true">
    <div id="tsPopup" role="dialog" aria-modal="true" aria-labelledby="tsPopupText">
      <p id="tsPopupText">-</p>
      <button id="tsPopupBtn" type="button">확인</button>
    </div>
  </div>

  <script>
    // ===== popup =====
    const layer = document.getElementById("tsPopupLayer");
    const textEl = document.getElementById("tsPopupText");
    const btnEl  = document.getElementById("tsPopupBtn");

    function openPopup(message){
      textEl.textContent = message;
      layer.style.display = "flex";
      layer.setAttribute("aria-hidden","false");
      btnEl.focus();
    }
    function closePopup(){
      layer.style.display = "none";
      layer.setAttribute("aria-hidden","true");
    }
    btnEl.addEventListener("click", closePopup);
    window.addEventListener("keydown", (e)=>{
      if(e.key === "Escape" && layer.style.display === "flex") closePopup();
    });

    // ===== form / result =====
    const form = document.getElementById("tsFindForm");
    const nameEl  = document.getElementById("tsName");
    const emailEl = document.getElementById("tsEmail");

    const resultSection = document.getElementById("tsResultSection");
    const foundIdEl = document.getElementById("tsFoundId");

    const toStr = (v) => (v ?? "").toString().trim();

    // ✅ 더미 DB (나중에 서버 연동)
    // "아이디"가 이메일인 구조라면, email이 곧 아이디!
    const members = [
        { name: "홍길동", email: "trendscope@naver.com", loginId: "TrendScope" },
        { name: "김철수", email: "chulsoo.kim@naver.com", loginId: "chulsoo_97" },
        { name: "이영희", email: "younghee.lee@naver.com", loginId: "yhlee" }
    ];


    function showResult(foundId){
      form.classList.add("isHidden");
      resultSection.classList.remove("isHidden");
      foundIdEl.textContent = foundId;
    }

    // 아주 가벼운 이메일 체크(원하면 더 빡세게 가능)
    function looksLikeEmail(v){
      return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v);
    }

    form.addEventListener("submit", (e)=>{
      e.preventDefault();

      const name  = toStr(nameEl.value);
      const email = toStr(emailEl.value).toLowerCase();

      if(!name){
        return openPopup("이름 항목은\n필수 입력값입니다.");
      }
      if(!email){
        return openPopup("이메일 항목은\n필수 입력값입니다.");
      }
      if(!looksLikeEmail(email)){
        return openPopup("이메일 형식이 올바르지 않습니다.\n예) trendscope@naver.com");
      }

      // ✅ 핵심: 이름 + 이메일로 매칭해서 '아이디(=이메일)' 결과 표시
      const matched = members.find(m =>
        m.name === name && m.email.toLowerCase() === email
      );

      if(!matched){
        return openPopup(
          "입력하신 정보로 가입된 회원을 찾을 수 없습니다.\n회원가입 후 이용해 주세요."
        );
      }

      showResult(matched.loginId);
    });
  </script>
</body>
</html>
